{"ast":null,"code":"var _jsxFileName = \"/home/muhibullahkamali/GitHub/diaries-app/src/features/auth/Auth.tsx\";\nimport React, { useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport * as Yup from 'yup';\nimport http from '../../services/api';\nimport { saveToken, setAuthState } from './authSlice';\nimport { setUser } from './userSlice';\nimport { useAppDispatch } from '../../store';\nconst schema = Yup.object().shape({\n  username: Yup.string().required('What? No username?').max(16, 'Username cannot be longer than 16 characters'),\n  password: Yup.string().required('Without a password, \"None shall pass!\"'),\n  email: Yup.string().email('Please provide a valid email address (abc@xy.z)')\n});\n\nconst Auth = () => {\n  const {\n    handleSubmit,\n    register,\n    errors\n  } = useForm({\n    validationSchema: schema\n  });\n  const [isLogin, setIsLogin] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const dispatch = useAppDispatch();\n\n  const submitForm = data => {\n    const path = isLogin ? '/auth/login' : '/auth/signup';\n    http.post(path, data).then(res => {\n      if (res) {\n        const {\n          user,\n          token\n        } = res;\n        dispatch(saveToken(token));\n        dispatch(setUser(user));\n        dispatch(setAuthState(true));\n      }\n    }).catch(error => {\n      console.log(error);\n    }).finally(() => {\n      setLoading(false);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"auth\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit(submitForm),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputWrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: register,\n    name: \"username\",\n    placeholder: \"Username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }\n  }), errors && errors.username && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 15\n    }\n  }, errors.username.message)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputWrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: register,\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }\n  }), errors && errors.password && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 15\n    }\n  }, errors.password.message)), !isLogin && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputWrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: register,\n    name: \"email\",\n    placeholder: \"Email (optional)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 15\n    }\n  }), errors && errors.email && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, errors.email.message)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputWrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, isLogin ? 'Login' : 'Create account')), /*#__PURE__*/React.createElement(\"p\", {\n    onClick: () => setIsLogin(!isLogin),\n    style: {\n      cursor: 'pointer',\n      opacity: 0.7\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, isLogin ? 'No account? Create one' : 'Already have an account?'))));\n};\n\nexport default Auth;","map":{"version":3,"sources":["/home/muhibullahkamali/GitHub/diaries-app/src/features/auth/Auth.tsx"],"names":["React","useState","useForm","Yup","http","saveToken","setAuthState","setUser","useAppDispatch","schema","object","shape","username","string","required","max","password","email","Auth","handleSubmit","register","errors","validationSchema","isLogin","setIsLogin","loading","setLoading","dispatch","submitForm","data","path","post","then","res","user","token","catch","error","console","log","finally","message","cursor","opacity"],"mappings":"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","sourcesContent":["import React, { FC, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { User } from '../../interfaces/user.interface';\nimport * as Yup from 'yup';\nimport http from '../../services/api';\nimport { saveToken, setAuthState } from './authSlice';\nimport { setUser } from './userSlice';\nimport { AuthResponse } from '../../services/mirage/routes/user';\nimport { useAppDispatch } from '../../store';\n\nconst schema = Yup.object().shape({\n  username: Yup.string()\n    .required('What? No username?')\n    .max(16, 'Username cannot be longer than 16 characters'),\n  password: Yup.string().required('Without a password, \"None shall pass!\"'),\n  email: Yup.string().email('Please provide a valid email address (abc@xy.z)'),\n});\n\nconst Auth: FC = () => {\n  const { handleSubmit, register, errors } = useForm<User>({\n    validationSchema: schema,\n  });\n\n  const [isLogin, setIsLogin] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const dispatch = useAppDispatch();\n\n  const submitForm = (data: User) => {\n    const path = isLogin ? '/auth/login' : '/auth/signup';\n    http\n      .post<User, AuthResponse>(path, data)\n      .then((res) => {\n        if (res) {\n          const { user, token } = res;\n          dispatch(saveToken(token));\n          dispatch(setUser(user));\n          dispatch(setAuthState(true));\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  return (\n    <div className=\"auth\">\n      <div className=\"card\">\n        <form onSubmit={handleSubmit(submitForm)}>\n          <div className=\"inputWrapper\">\n            <input ref={register} name=\"username\" placeholder=\"Username\" />\n            {errors && errors.username && (\n              <p className=\"error\">{errors.username.message}</p>\n            )}\n          </div>\n\n          <div className=\"inputWrapper\">\n            <input\n              ref={register}\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"Password\"\n            />\n            {errors && errors.password && (\n              <p className=\"error\">{errors.password.message}</p>\n            )}\n          </div>\n\n          {!isLogin && (\n            <div className=\"inputWrapper\">\n              <input\n                ref={register}\n                name=\"email\"\n                placeholder=\"Email (optional)\"\n              />\n              {errors && errors.email && (\n                <p className=\"error\">{errors.email.message}</p>\n              )}\n            </div>\n          )}\n\n          <div className=\"inputWrapper\">\n            <button type=\"submit\" disabled={loading}>\n              {isLogin ? 'Login' : 'Create account'}\n            </button>\n          </div>\n\n          <p\n            onClick={() => setIsLogin(!isLogin)}\n            style={{ cursor: 'pointer', opacity: 0.7 }}\n          >\n            {isLogin ? 'No account? Create one' : 'Already have an account?'}\n          </p>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}